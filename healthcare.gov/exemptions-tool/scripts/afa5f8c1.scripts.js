"use strict";angular.module("exemptionsScreenerApp",["ngCookies","ngResource","ngSanitize","ngRoute","ngAnimate","ui.router","Config","Question","Results","Details","Tracking"]).config(["$urlRouterProvider",function(e){e.when("","/").otherwise("/")}]),function(){angular.module("Util",[])}();var util=angular.module("Util");util.factory("_",function(){return window._});var util=angular.module("Util");util.factory("arraysUtil",function(){return{getContiguousGroups:function(e,t){var n,r=[],i=[];if(!_.isArray(e)||!_.isArray(t))return r;for(var o=0;e.length>o;o++){var a=_.indexOf(t,e[o]);a>=0&&(_.isUndefined(n)||n+1==a?i.push(e[o]):(r.push(i),i=[e[o]]),n=a)}return i.length>0&&r.push(i),r}}});var util=angular.module("Util");util.factory("exemptionsUtil",["_",function(e){return{calculateFPL:function(t,n,r,i,o){var a,s,u,l;if(!(e.isUndefined(t)||e.isNull(t)||e.isUndefined(i)||e.isNull(i)))return e.isUndefined(n)||e.isNull(n)?n=0:e.isUndefined(r)||e.isNull(r)?r=1:(e.isUndefined(o)||e.isNull(o))&&(o=0),a=i+o,s=r*(a>=0?a:0),u=n+s,l=t,100*(l/u)}}}]),function(){var e=angular.module("Util");e.factory("objectUtil",["_",function(e){return{isDefined:function(t){return!e.isNull(t)&&!e.isUndefined(t)},getPropertyFromPath:function(t,n,r){var i,o,a;if(r||(r="."),i=e.isString(t)?t.split(r):[],o=n,a=0,!e.isEmpty(i)){for(;o&&i.length>a;)o=e.has(o,i[a])?o[i[a]]:void 0,a+=1;return o}}}}])}();var util=angular.module("Util");util.factory("questionsUtil",function(){return{extractAnswerIds:function(e){return _.isUndefined(e)||_.isNull(e)?[]:_.isArray(e)?_.pluck(e,"id"):[e.id]}}});var util=angular.module("Util");util.factory("stringsUtil",["_",function(e){return{formatString:function(t){var n=e.toArray(arguments).slice(1);return e.isString(t)?t.replace(/{(\d+)}/g,function(t,r){return e.isUndefined(n[r])?"":n[r]}):""}}}]),function(){var e=angular.module("Util");e.filter("trust",["$sce",function(e){return e.trustAsHtml}])}(),function(){var e=angular.module("exemptionsScreenerApp");e.run(["translationsService","configurationService",function(e,t){var n=e.getLanguage();angular.element("html").attr("lang",n),document.title=t.get("application.appName."+n)+" | "+t.get("application.siteName."+n)}])}(),function(){angular.module("exemptionsScreenerApp").directive("skipNav",["$rootScope","$location","$anchorScroll","translationContentService",function(e,t,n,r){return{scope:{label:"@label",t:"@"},replace:!0,restrict:"A",controller:["$scope",function(e){r.getContentForPage("header").then(function(t){e.t=t})}],link:function(e,r){$(r).click(function(e){e.preventDefault(),i()});var i=function(){t.hash("exemptionMainView"),n();var e=document.getElementById("exemptionMainView");e&&e.focus()}},templateUrl:"modules/module_app/directives/templates/skip-nav.html"}}])}(),function(){angular.module("Session",["Util"])}();var sessions=angular.module("Session");sessions.factory("sessionsService",["_",function(e){var t=function(){this.flags=[],this.profile={},this.history=[]},n=function(){this.data=new t};return n.prototype.reset=function(){this.data=new t},n.prototype.addFlag=function(t){e.isArray(t)||(t=[t]),t=e.filter(t,function(t){return e.isString(t)}),this.data.flags=this.data.flags.concat(t)},n.prototype.hasFlags=function(t){var n=this;if(e.isArray(t))return e.every(t,function(e){return n.hasFlag(e)})},n.prototype.hasFlag=function(t){return e.contains(this.data.flags,t)},n.prototype.getFlags=function(){return this.data.flags},n.prototype.removeFlag=function(t){e.isArray(t)||(t=[t]);for(var n=0;t.length>n;n++){var r=e.indexOf(this.data.flags,t[n]);r>=0&&(this.data.flags[r]=null)}this.data.flags=e.compact(this.data.flags)},n.prototype.pushToHistory=function(t){e.isObject(t)&&this.data.history.push(t)},n.prototype.popFromHistory=function(){return this.data.history.pop(history)},n.prototype.hasHistory=function(){return this.data.history.length>0},n.prototype.getHistory=function(){return this.data.history},n.prototype.getProfile=function(){return angular.copy(this.data.profile)},n.prototype.getProfileProperty=function(e){var t;return this.hasProfileProperty(e)&&(t=this.data.profile[e]),t},n.prototype.setProfileProperty=function(t,n){e.isString(t)&&(this.data.profile[t]=n)},n.prototype.hasProfileProperty=function(t){return e.has(this.data.profile,t)},new n}]),function(){angular.module("Config",["Util"])}(),function(){var e=angular.module("Config");e.factory("configurationDataService",["_",function(e){var t=function(e){this.config=e};t.prototype.getConfig=function(){return this.config};var n=angular.copy(gov.hc.exmsr.config);return e.has(n,"env")||(n.env={}),n.env=e.extend(n.env,gov.hc.exmsr.env),new t(n)}])}(),function(){var e=angular.module("Config");e.factory("configurationService",["objectUtil","configurationDataService",function(e,t){var n=function(e){this.config=e},r=t.getConfig();return n.prototype.get=function(t){return e.getPropertyFromPath(t,this.config)},new n(r)}])}(),function(){var e=angular.module("Config");e.factory("translationsService",["_","objectUtil","configurationService",function(e,t,n){var r=function(e){this.translationsObj=e};return r.prototype.isSpanishLocation=function(){var e=n.get("site.spanish.domain");return window.location.host.indexOf(e)>=0||window.location.pathname.indexOf("/es/")>=0},r.prototype.getLanguage=function(){return this.isSpanishLocation()?n.get("site.spanish.lang"):n.get("site.english.lang")},new r}])}(),function(){angular.module("Content",["Util","Config","Session"])}(),function(){var e=angular.module("Config");e.factory("translationDataService",["_",function(e){var t=function(t){var n,r=angular.copy(t["default"]),i={"default":r};n=function(t,r){for(var i in r)e.has(t,i)?n(t[i],r[i]):t[i]=r[i];return t};for(var o in t)"default"!==o&&(i[o]=n(angular.copy(r),t[o]));this.translations=i};return t.prototype.getTranslations=function(t){return e.has(this.translations,t)?this.translations[t]:this.translations["default"]},new t(angular.copy(gov.hc.exmsr.translations))}])}(),function(){var e=angular.module("Content");e.factory("translationContentService",["$q","_","objectUtil","translationsService","translationDataService","sessionsService",function(e,t,n,r,i,o){var a=function(e){this.dataService=e},s=function(){return r.getLanguage()},u=function(n,r){var i=e.defer();return n||(n=s()),t.has(r,n)?i.resolve(r[n]):i.resolve({}),i.promise};return a.prototype.getTranslations=function(e,t){var n,r;return t?n=this.dataService.getTranslations(t):(r=o.hasProfileProperty("year")?o.getProfileProperty("year").value:void 0,n=this.dataService.getTranslations(r)),u(e,n)},a.prototype.getTranslatedProperty=function(e,t,r){return r?this.getTranslations(t,r).then(function(t){return n.getPropertyFromPath(e,t)}):this.getTranslations(t).then(function(t){return n.getPropertyFromPath(e,t)})},a.prototype.get=function(e,t,n){return n?this.getTranslatedProperty(e,t,n):this.getTranslatedProperty(e,t)},a.prototype.getContentForPage=function(e,t,n){return n?this.get(e,t,n):this.get(e,t)},new a(i)}])}(),function(){var e=angular.module("Content");e.factory("htmlContentService",["$http","$q","_","objectUtil","translationsService","configurationService",function(e,t,n,r,i,o){var a,s=function(){};return a=function(){return i.getLanguage()},s.prototype.get=function(r,i){var s,u=t.defer();return i||(i=a()),console.log("inside content get"),n.isString(r)?(s=o.get("content.html.pathToHTML")+i+"/"+r.replace(".","/")+".html",e.get(s).success(function(e){u.resolve(e)}).error(function(){u.resolve()})):u.reject("Invalid path specified."),u.promise},s.prototype.getContentForPage=function(e,t){return this.get(e,t)},new s}])}(),function(){angular.module("HCForms",[])}(),function(){angular.module("HCForms").directive("textDirective",function(){return{restrict:"E",templateUrl:"modules/module_form/views/input_text.html",link:function(){},controller:["$scope",function(){}],scope:{id:"=",required:"=",label:"=",ngClick:"&",ngBlur:"&"}}})}(),function(){angular.module("ZipCode",[])}(),function(){angular.module("ZipCode").directive("typeAhead",["$rootScope","$timeout","configurationService",function(e,t,n){return{replace:!0,restrict:"EA",require:"ngModel",templateUrl:"modules/module_zip/partials/zip-code.html",link:function(e,r,i,o){o.$setValidity("selected",!1),o.$setViewValue(null),e.selectZipCode=!1,e.$emit("contentViewLoaded");var a=new Bloodhound({datumTokenizer:Bloodhound.tokenizers.obj.whitespace("value"),queryTokenizer:Bloodhound.tokenizers.whitespace,remote:{url:n.get("env.geo.url")+n.get("site.zipLookup"),transport:function(e,t,r,i){function o(e){r(e)}function a(e,t,n){i(n)}var s={url:e,type:"GET",dataType:"json"},u=n.get("env.geo.token");u&&""!==u&&(s.url+="&apikey="+u),$.ajax(s).done(o).fail(a)},filter:function(e){var t=[];return angular.forEach(e,function(e){angular.forEach(e.counties,function(n){t.push({name:e.zip_code+" "+n.county_name+" COUNTY, "+n.state_code,zipcode:e.zip_code,state:n.state_code})})}),t}}});a.initialize();var s=angular.element(r[0]).find(".typeahead"),u={hint:!0,highlight:!0,minLength:1},l={name:"bloodhound",displayKey:"name",source:a.ttAdapter()};s.typeahead(u,l),s.on("typeahead:selected typeahead:autocompleted",function(n,r){n.stopPropagation(),t(function(){r&&(o.$setViewValue(r),o.$setValidity("selected",!0),e.selectZipCode=!1)},0)}),s.on("blur",function(){var n=s.val(),r=o.$viewValue,i=null;r&&r.hasOwnProperty("name")&&(i=r.name),i&&i===n||t(function(){e.selectZipCode=!0,o.$setViewValue(null),o.$setValidity("selected",!1)},0)}),s.on("keyup",function(e){t(function(){(13==e.keycode||13==e.which)&&angular.element(r[0]).find(".tt-suggestion:first").trigger("click")},0)}),e.$on("$destroy",function(){})}}}])}(),function(){angular.module("Exemptions",["Util","Session","Config"])}(),function(){var e=angular.module("Exemptions");e.factory("affordabilityThresholdCalculator",["_","configurationService","sessionsService","objectUtil",function(e,t,n){var r,i={householdIncome:void 0};return r=function(){},r.prototype.getHouseholdIncome=function(t){return parseFloat(e.property("householdIncome")(t))},r.prototype.meetsPrerequisites=function(t){var r=(e.extend(angular.copy(i),t),this.getHouseholdIncome(t)),o=n.hasProfileProperty("year");return!e.isNaN(r)&&o},r.prototype.calculate=function(r){var o,a=n.hasProfileProperty("year")?n.getProfileProperty("year").value:null,s=t.get("exemptions.calculations.affordabilityThreshold"),u=s.incomeMultipler[a],l=s.incomeDivisor[a];return r=e.extend(angular.copy(i),r),o=this.getHouseholdIncome(r),e.isNaN(o)?void 0:(o/l*u).toFixed(2)},r.prototype.storeResult=function(n,r){n&&e.isFunction(n.setProfileProperty)&&n.setProfileProperty(t.get("profile.affordabilityThreshold"),r)},new r}])}(),function(){var e=angular.module("Exemptions");e.factory("fplCalculator",["_","configurationService","exemptionsUtil","objectUtil",function(e,t,n,r){var i=function(){},o={location:{state:void 0},householdIncome:void 0,householdSize:void 0,year:{value:void 0}};return i.prototype.getLocation=e.property("location"),i.prototype.getHouseholdIncome=function(t){return parseFloat(e.property("householdIncome")(t))},i.prototype.getHouseholdSize=function(t){return parseInt(e.property("householdSize")(t))},i.prototype.getSelectedYear=e.property("year"),i.prototype.meetsPrerequisites=function(t){var n=e.extend(angular.copy(o),t),i=this.getLocation(n),a=this.getHouseholdIncome(n),s=this.getHouseholdSize(n),u=this.getSelectedYear(n);return r.isDefined(i)&&r.isDefined(i.state)&&!e.isNaN(a)&&!e.isNaN(s)&&r.isDefined(u.value)},i.prototype.calculate=function(i){var a,s,u,l,c,f,p,d,h=t.get("exemptions.calculations.fpl");return i=e.extend(angular.copy(o),i),a=this.getLocation(i),s=this.getHouseholdIncome(i),u=this.getHouseholdSize(i),p=this.getSelectedYear(i),f=r.isDefined(a.state)&&e.isString(a.state)?a.state.toLowerCase():null,d=r.isDefined(p.value)&&e.isString(p.value)?p.value:null,!f||e.isNaN(s)||e.isNaN(u)?void 0:(l=e.has(h,f)?h[f]:h["default"],c=n.calculateFPL(s,l.baseMinimum[d],l.sizeMultiplier[d],u,l.sizeModifier[d]))},i.prototype.storeResult=function(n,r){n&&e.isFunction(n.setProfileProperty)&&n.setProfileProperty(t.get("profile.fpl"),r)},new i}])}(),function(){var e=angular.module("Exemptions");e.factory("secretaryHardshipCalculator",["_","configurationService","sessionsService","objectUtil",function(e,t,n,r){var i,o={location:{state:void 0},fpl:void 0};return i=function(e){this.flags=e},i.prototype.getLocation=e.property("location"),i.prototype.getFPL=e.property("fpl"),i.prototype.meetsPrerequisites=function(t){var i=e.extend(angular.copy(o),t),a=this.getLocation(i),s=this.getFPL(i),u=n.hasProfileProperty("year");return r.isDefined(a)&&r.isDefined(a.state)&&r.isDefined(s)&&u},i.prototype.calculate=function(i){var a,s,u,l;return l=n.hasProfileProperty("year")?n.getProfileProperty("year").value:null,i=e.extend(angular.copy(o),i),s=this.getLocation(i),u=this.getFPL(i),a={medicaidStates:t.get("exemptions.medicaidExpansionStates."+l),fplCutoff:t.get("exemptions.calculations.secretaryHardship.fplCutoff."+l)},r.isDefined(s.state)&&r.isDefined(u)?a.fplCutoff>u&&!e.contains(a.medicaidStates,s.state):void 0},i.prototype.storeResult=function(t,n){t&&e.isFunction(t.addFlag)&&(n&&!t.hasFlags(this.flags)?t.addFlag(this.flags):n||t.removeFlag(this.flags))},new i(t.get("exemptions.calculations.secretaryHardship.flagNames"))}])}(),function(){var e=angular.module("Exemptions");e.factory("incomeThresholdCalculator",["_","configurationService","sessionsService","objectUtil",function(e,t,n,r){var i=function(){},o={filingStatus:void 0,age:void 0,spouseAge:void 0},a=["single","head","marriedJointly","marriedSeparately","widowWithChildren"];return i.prototype.getAge=e.property("age"),i.prototype.getSpouseAge=e.property("spouseAge"),i.prototype.getTaxStatus=function(t){var n;if(t)return n=e.property("filingStatus")(t),e.isString(n)&&e.contains(a,n)?n:void 0},i.prototype.isSingleStatus=function(e){return e&&"single"===e},i.prototype.isHeadOfHouseStatus=function(e){return e&&"head"===e},i.prototype.isMarriedJointlyStatus=function(e){return e&&"marriedJointly"===e},i.prototype.isMarriedSeparatelyStatus=function(e){return e&&"marriedSeparately"===e},i.prototype.isWidowWithChildrenStatus=function(e){return e&&"widowWithChildren"===e},i.prototype.isBelowAgeCutoff=function(e){return e&&65>e},i.prototype.getIncomeCategory=function(e,t,n){var r="";return"marriedSeparately"===e?e:(r+=e+".",r+="marriedJointly"===e?65>t&&65>n?"u65b":t>=65&&n>=65?"oe65b":"oe65o":65>t?"u65":"oe65")},i.prototype.meetsPrerequisites=function(t){var i,a=e.extend(angular.copy(o),t),s=this.getTaxStatus(a),u=this.getAge(a),l=this.getSpouseAge(a),c=n.hasProfileProperty("year");return i=r.isDefined(u)&&r.isDefined(s),i&&this.isMarriedJointlyStatus(s)&&(i=r.isDefined(l)),i=i&&c},i.prototype.calculate=function(i){var a,s,u,l,c,f;return i=e.extend(angular.copy(o),i),a=this.getTaxStatus(i),s=this.getAge(i),u=this.getSpouseAge(i),c=this.getIncomeCategory(a,s,u),f=n.hasProfileProperty("year")?n.getProfileProperty("year").value:null,r.isDefined(s)&&r.isDefined(a)&&(!this.isMarriedJointlyStatus(a)||r.isDefined(u))?l=t.get("exemptions.calculations.incomeThreshold.categories."+c+"."+f):void 0},i.prototype.storeResult=function(t,n){t&&e.isFunction(t.setProfileProperty)&&t.setProfileProperty("incomeThreshold",n)},new i}])}(),function(){var e=angular.module("Exemptions");e.factory("belowThresholdCalculator",["_","configurationService","objectUtil",function(e,t,n){var r,i={householdIncome:void 0,incomeThreshold:void 0};return r=function(e){this.flags=e},r.prototype.getIncome=function(t){return parseFloat(e.property("householdIncome")(t))},r.prototype.getIncomeThreshold=e.property("incomeThreshold"),r.prototype.meetsPrerequisites=function(t){var r=e.extend(angular.copy(i),t),o=this.getIncome(r),a=this.getIncomeThreshold(r);return!e.isNaN(o)&&n.isDefined(a)},r.prototype.calculate=function(t){var r,o;return t=e.extend(angular.copy(i),t),r=this.getIncome(t),o=this.getIncomeThreshold(t),!e.isNaN(r)&&n.isDefined(o)?o>=r:void 0},r.prototype.storeResult=function(t,n){t&&e.isFunction(t.addFlag)&&(n&&!t.hasFlags(this.flags)?t.addFlag(this.flags):n||t.removeFlag(this.flags))},new r(t.get("exemptions.calculations.incomeThreshold.flagNames"))}])}(),function(){var e=angular.module("Exemptions");e.factory("exemptionCalculatorsService",["fplCalculator","secretaryHardshipCalculator","incomeThresholdCalculator","belowThresholdCalculator","affordabilityThresholdCalculator",function(e,t,n,r,i){var o,a,s=function(){this.calculators=[]};return a=function(e){return e&&_.isFunction(e.meetsPrerequisites)&&_.isFunction(e.calculate)&&_.isFunction(e.storeResult)},s.prototype.addCalculator=function(e){a(e)&&this.calculators.push(e)},s.prototype.getCalculators=function(){return this.calculators},o=new s,o.addCalculator(e),o.addCalculator(n),o.addCalculator(i),o.addCalculator(t),o.addCalculator(r),o}])}(),function(){var e=angular.module("Exemptions");e.factory("exemptionsService",["exemptionCalculatorsService","sessionsService",function(e,t){var n=function(e){this.calculators=e};return n.prototype.process=function(){for(var e=t.getProfile(),n=0;this.calculators.length>n;n++){var r=this.calculators[n];r.meetsPrerequisites(e)&&r.storeResult(t,r.calculate(e))}},new n(e.getCalculators())}])}(),function(){angular.module("ExemptionsYear",["Util","Session","Config","Content","ngRoute","ui.router","Exemptions"])}(),function(){var e=angular.module("ExemptionsYear");e.controller("YearPageController",["$scope","$http","$state","$route","$uiViewScroll","$timeout","translationContentService","exemptionsYearService","exemptionsDataService","blastService",function(e,t,n,r,i,o,a,s,u,l){a.getContentForPage("questions.year").then(function(t){e.t=t,c()}),e.setSelectedYear=function(){var t=e.selected;s.resetSession(),s.setYear(e.t.id,t),u.loadData(),l.trackEvent("year","choose-tax-year",t.value),n.go("questions.screens")};var c=function(){document.activeElement&&document.activeElement.blur();var e=document.getElementById("exemptionMainView");e&&i(angular.element(e));var t=".question_view legend, .question_view label",n=$(t);n&&0!=n.length&&(o(function(){var n=$(t);n&&(e.focus(),n.filter(":first").attr("tabindex",-1).focus())}),l.pageView("year"))}}])}(),function(){var e=angular.module("ExemptionsYear");e.factory("exemptionsYearService",["_","configurationService","sessionsService",function(e,t,n){var r=function(){function r(r,i){for(var o=t.get(r),a=n.getProfileProperty(i),s="",u=0,l=o.length-1;l>=u;u+=1)e.has(o[u],"id")&&e.has(a,"id")&&o[u].id===a.id&&(s=o[u].url);return s}var i={},o="year",a="questions.pathToJSON",s="exemptions.pathToJSON";return i.resetSession=function(){n.reset()},i.setYear=function(e,t){n.setProfileProperty(e,t)},i.getDataPath=function(){return r(a,o)},i.getExemptionsPath=function(){return r(s,o)},i};return new r}])}(),function(){var e=angular.module("ExemptionsYear");e.directive("selectYear",[function(){return{restrict:"EA",require:"?ngModel",controller:"YearPageController",link:function(e,t,n,r){r&&t.bind("keyup",function(){t.triggerHandler("change")})}}}])}(),function(){angular.module("ExemptionsYear").config(["$stateProvider",function(e){e.state("questions.year",{url:"year",templateUrl:"modules/module_exemptionsyear/views/year.html",controller:"YearPageController as yearCntrl"})}])}(),function(){angular.module("Question",["Util","Session","Config","Content","ngRoute","ui.router","ngAnimate","HCForms","ZipCode","Exemptions","ngSanitize","ExemptionsYear"])}(),function(){var e=angular.module("Question");e.factory("modifiersService",["_","arraysUtil","questionsUtil",function(e,t,n){return{get:function(){return{length:function(t){if(null===t)return-1;var n=e.isArray(t)?t:[t];return e.compact(n).length},objectify:function(t){var n;if(!e.isString(t))return t;try{n=JSON.parse(t)}catch(r){n=t}return n},property:function(t,n,r){var i;if(e.isString(r)||e.isObject(t)||e.isString(t))return e.has(t,r)&&(i=t[r]),i},longestContiguous:function(r,i){var o=e.isArray(r)?r:[r],a=n.extractAnswerIds(i),s=t.getContiguousGroups(o,a),u=e.size(e.max(s,function(e){return e.length}));return u},groupSizes:function(r,i){var o=e.isArray(r)?r:[r],a=n.extractAnswerIds(i),s=t.getContiguousGroups(o,a);return e.map(s,function(e){return e.length})},numContiguousGroups:function(r,i){var o=e.isArray(r)?r:[r],a=n.extractAnswerIds(i),s=t.getContiguousGroups(o,a);return e.size(s)},parseCurrency:function(e){return void 0===e||null===e?0/0:(e=(""+e).replace("$","").replace(/,/g,""),parseFloat(e))}}}}}])}(),function(){var e=angular.module("Question");e.factory("operatorsService",["_","sessionsService","arraysUtil","questionsUtil","modifiersService",function(e,t,n){function r(){var r=t.getProfileProperty("no-coverage-months"),i=e.isArray(r)?r:[r],o=["jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec"],a=n.getContiguousGroups(i,o),s=e.size(e.max(a,function(e){return e.length}));return s}return{get:function(){return{eq:function(e,t){return e==t},lt:function(e,t){return t>e},gt:function(e,t){return e>t},lte:function(e,t){return t>=e},gte:function(e,t){return e>=t},not:function(e,t){return e!=t},all:function(t,n){var r=e.isArray(t)?t:[t],i=e.isArray(n)?n:[n],o=e.every(i,function(e){for(var t=!1,n=0;!t&&r.length>n;)t=e==r[n++];return t});return o&&r.length===i.length},allAllowOthers:function(t,n){var r=e.isArray(t)?t:[t],i=e.isArray(n)?n:[n],o=e.every(i,function(e){for(var t=!1,n=0;!t&&r.length>n;)t=e==r[n++];return t});return o},some:function(t,n){var r=e.isArray(t)?t:[t],i=e.isArray(n)?n:[n],o=e.some(i,function(e){for(var t=!1,n=0;!t&&r.length>n;)t=e==r[n++];return t});return o},only:function(t,n){var r=e.isArray(t)?t:[t],i=e.isArray(n)?n:[n],o=e.every(r,function(e){for(var t=!1,n=0;!t&&i.length>n;)t=e==i[n++];return t});return o},none:function(t,n){var r=e.isArray(t)?t:[t],i=e.isArray(n)?n:[n],o=e.every(i,function(e){for(var t=!1,n=0;!t&&r.length>n;)t=e==r[n++];return!t});return o},notOnly:function(t,n){var r=e.isArray(t)?t:[t],i=e.isArray(n)?n:[n],o=e.some(r,function(e){for(var t=!1,n=0;!t&&i.length>n;)t=e==i[n++];return!t});return o},hasAllFlags:function(n,r){return r?(e.isArray(r)||(r=[r]),e.every(r,function(e){return t.hasFlag(e)})):!1},hasSomeFlags:function(n,r){return r?(e.isArray(r)||(r=[r]),e.some(r,function(e){return t.hasFlag(e)})):!1},hasNoFlags:function(n,r){return r?(e.isArray(r)||(r=[r]),e.every(r,function(e){return!t.hasFlag(e)})):!1},showPrevNovDec:function(){var n=t.getProfileProperty("no-coverage-months");return 3>r()&&e.indexOf(n,"jan")>=0&&0>e.indexOf(n,"feb")?!0:!1},showPrevDec:function(){var n=t.getProfileProperty("no-coverage-months");return 3>r()&&e.indexOf(n,"jan")>=0&&e.indexOf(n,"feb")>=0&&0>e.indexOf(n,"mar")?!0:!1},checkShortGap:function(){var n=t.getProfileProperty("no-coverage-months");return 3>r()&&("yes-nov"==t.getProfileProperty("coverage-prior-nov")&&"no-dec"==t.getProfileProperty("coverage-prior-dec")&&0>e.indexOf(n,"feb")||"yes-dec"==t.getProfileProperty("coverage-prior-dec"))?!0:!1},inState:function(n,r){if(!r)return!1;e.isArray(r)||(r=[r]);var i=t.getProfileProperty("location");return e.indexOf(r,i.state)>-1},notInState:function(n,r){if(!r)return!1;e.isArray(r)||(r=[r]);var i=t.getProfileProperty("location");return 0>e.indexOf(r,i.state)},coveredDuringMonths:function(n,r){if(!r)return!1;e.isArray(r)||(r=[r]);var i=t.getProfileProperty("coverage-duration"),o=t.getProfileProperty("no-coverage-months"),a="coverage-partial"==i&&e.isEmpty(e.intersection(r,o));return a||"had-coverage"==i},notCoveredDuringMonths:function(n,r){if(!r)return!1;e.isArray(r)||(r=[r]);var i=t.getProfileProperty("coverage-duration"),o=t.getProfileProperty("no-coverage-months"),a="coverage-partial"==i&&e.isEmpty(e.intersection(r,o));return!(a||"had-coverage"==i)},notCoveredDuringAtLeastOneMonths:function(n,r){if(!r)return!1;e.isArray(r)||(r=[r]);var i=t.getProfileProperty("coverage-duration"),o=t.getProfileProperty("no-coverage-months"),a=e.intersection(r,o).length,s="coverage-partial"==i&&r.length>a;return!(s||"had-coverage"==i)},hasNoCoverage:function(){var e=t.getProfileProperty("coverage-duration");return!e||"no-coverage"==e},"default":function(){return!0}}}}}])}(),function(){var e=angular.module("Question");e.factory("transitionsService",["_","modifiersService","operatorsService",function(e,t,n){var r=function(e,t){this.modifiers=e,this.operators=t};return r.prototype.getOperator=function(t){return t&&this.hasOperator(t)?this.operators[t]:e.noop},r.prototype.getModifier=function(t){return t&&this.hasModifier(t)?this.modifiers[t]:e.noop},r.prototype.hasOperator=function(t){return e.isString(t)&&e.has(this.operators,t)},r.prototype.hasModifier=function(t){return e.isString(t)&&e.has(this.modifiers,t)},r.prototype.getDependentQuestions=function(t){var n=[];if(!e.isArray(t))return n;for(var r=0;t.length>r;r++){var i=t[r];if(e.has(i,"action")&&e.has(i.action,"goTo")){var o=i.action.goTo;e.has(o,"question")&&n.push(o.question)}}return n},r.prototype.applyModifiers=function(t,n,r){if(!e.isArray(t))return n;r||(r=null);for(var i=0;t.length>i;i++){var o=t[i];if(e.isString(o)){var a=o.split(/\s+/),s=a.shift();if(this.hasModifier(s)){var u=this.getModifier(s);a.unshift(r),a.unshift(n),n=u.apply(null,a)}}}return n},r.prototype.getAction=function(t,n,r){var i,o={goTo:null,setFlag:[]};if(!e.isArray(t))return o;i={areCompleteConditions:function(t){return e.isArray(t)&&e.every(t,function(e){return i.isCompleteCondition(e)})},isCompleteCondition:function(t){return e.isObject(t)&&e.has(t,"operator")},isCompleteTransition:function(t){return e.isObject(t)&&e.has(t,"action")&&i.areCompleteConditions(t.conditions)},mergeActions:function(t,n){return e.isObject(t.goTo)||(t.goTo=n.goTo),t.setFlag=e.union(t.setFlag,n.setFlag),t}};for(var a=0;t.length>a;a++){var s=t[a];if(i.isCompleteTransition(s)){for(var u=s.conditions,l=!0,c=0;l&&u.length>c;){var f=n,p=u[c++];if(e.isString(p.modifier)||e.isArray(p.modifier)){var d=e.isArray(p.modifier)?p.modifier:[p.modifier];f=this.applyModifiers(d,f,r)}if(this.hasOperator(p.operator)){var h=this.getOperator(p.operator),m=p.value;l=h(f,m)}else l=!1}l&&(o=i.mergeActions(o,s.action))}}return o},new r(t.get(),n.get())}])}(),function(){var e=angular.module("Question");e.factory("questionsDataService",["$http","$q","_","configurationService","exemptionsYearService",function(e,t,n,r,i){var o=function(){};return o.prototype.getData=function(){var n=this,r=t.defer();return e.get(i.getDataPath()).success(function(e){n.data=e}).error(function(){n.data={}})["finally"](function(){r.resolve(n.data)}),r.promise},o.prototype.getScreens=function(){var e=this,r=t.defer();return e.getData().then(function(e){var t;t=n.has(e,"screens")?e.screens:[],r.resolve(t)}),r.promise},new o}])}(),function(){var e=angular.module("Question");e.factory("questionContentService",["_","translationsService",function(e,t){var n,r,i=function(){};return n=function(t,n){return e.has(t,n)&&(e.isObject(t[n])||e.isString(t[n]))},r=function(n){var r;if(e.isObject(n)){var i=t.getLanguage();e.has(n,i)&&(r=n[i])}else e.isString(n)&&(r=n);return r},i.prototype.processScreen=function(t){if(!e.isObject(t))return t;if(n(t,"header")&&(t.header.content=r(t.header)),n(t,"intro")&&(t.intro.content=r(t.intro)),n(t,"questions"))for(var i=t.questions,o=0;i.length>o;o++)i[o]=this.processQuestion(i[o]);return t},i.prototype.processQuestion=function(t){if(!e.isObject(t))return t;if(n(t,"text")&&(t.text.content=r(t.text)),n(t,"placeholder")&&(t.placeholder.content=r(t.placeholder)),n(t,"help")&&(t.help.content=r(t.help)),n(t,"validation"))for(var i=e.keys(t.validation),o=0;i.length>o;o++){var a=i[o],s=t.validation[a];n(s,"text")&&(s.text.content=r(s.text))}if(n(t,"answers"))for(var u=t.answers,o=0;u.length>o;o++)u[o]=this.processAnswer(u[o]);return t},i.prototype.processAnswer=function(t){return e.isObject(t)?(n(t,"text")&&(t.text.content=r(t.text)),t):t},new i}])}(),function(){var e=angular.module("Question");e.factory("questionsService",["$q","_","transitionsService","sessionsService","questionsDataService","configurationService","exemptionsService","questionContentService",function(e,t,n,r,i,o,a,s){var u=function(e){this.dataService=e};return u.prototype.loadScreens=function(){var e=function(e){for(var n,r,i={},o=0;e.length>o;o++){var a=e[o],u=a.id,l={obj:s.processScreen(a),next:null};n?r&&(i[r].next=u):n=u,i[u]=l,r=u}return new function(e,n){this.index=e,this.first=n,this.getScreen=function(e){var n;return t.isString(e)&&this.has(e)&&(n=angular.copy(this.getNode(e).obj)),n},this.getFirstScreen=function(){return this.getScreen(this.first)},this.getNode=function(e){return this.index[e]},this.has=function(e){return e&&t.has(this.index,e)}}(i,n)};this.screensPromise=this.dataService.getScreens().then(function(t){return e(t)})},u.prototype.getFirstScreen=function(){return this.screensPromise.then(function(e){return e.getFirstScreen()})},u.prototype.getNextQuestion=function(r,i,o){var a,s,u=e.defer();return r&&i?(a={goTo:{question:null,screen:null,results:!1,redirect:null,kickout:null}},s=n.getAction(i.transitions,o,i.answers),s&&(t.has(s,"goTo")&&this.isQuestionReference(s.goTo)&&(a.goTo.question=this.getQuestionById(r.questions,s.goTo.question)),a.setFlag=s.setFlag),u.resolve(a),u.promise):(u.reject("Missing required parameter (screen, question)"),u.promise)},u.prototype.getNextScreen=function(r,i,o){var a,s,u=e.defer(),l=this;return r&&i?(a={goTo:{question:null,screen:null,results:!1,redirect:null,kickout:null}},s=n.getAction(i.transitions,o,i.answers),s&&(a.setFlag=s.setFlag,t.has(s,"goTo")&&(this.isResultReference(s.goTo)?(a.goTo.results=!0,u.resolve(a)):this.isRedirectReference(s.goTo)?(a.goTo.redirect=s.goTo.redirect,u.resolve(a)):this.isScreenReference(s.goTo)?this.getScreen(s.goTo.screen).then(function(t){var r=function(t){var i=e.defer();if(t.preconditions){var o=n.getAction(t.preconditions);o.goTo&&o.goTo.screen?l.getScreen(o.goTo.screen).then(function(e){r(e).then(function(e){i.resolve(e)})}):i.resolve(t)}else i.resolve(t);return i.promise};r(t).then(function(e){a.goTo.screen=e,u.resolve(a)})}):this.isKickoutReference(s.goTo)?(a.goTo.kickout=s.goTo.kickout,u.resolve(a)):u.resolve(a))),u.promise):(u.reject("Missing required parameter (screen, question)"),u.promise)},u.prototype.getQuestionById=function(e,n){if(t.isArray(e)&&t.isString(n)){for(var r,i=0;!r&&e.length>i;){var o=e[i++];o.id==n&&(r=o)}return r}},u.prototype.getQuestionByIndex=function(e,n){if(t.isArray(e)&&t.isNumber(n)){var r;return e.length>n&&(r=e[n]),r}},u.prototype.getQuestionTypes=function(){return o.get("questions.availableTypes")},u.prototype.getScreen=function(e){return this.screensPromise.then(function(t){return t.getScreen(e)})},u.prototype.isResultReference=function(e){return e&&t.has(e,"results")&&e.results===!0},u.prototype.isScreenReference=function(e){return e&&t.has(e,"screen")&&t.isString(e.screen)},u.prototype.isQuestionReference=function(e){return e&&t.has(e,"question")&&t.isString(e.question)},u.prototype.isRedirectReference=function(e){return e&&t.has(e,"redirect")&&t.isString(e.redirect)},u.prototype.isKickoutReference=function(e){return e&&t.has(e,"kickout")&&t.isString(e.kickout)},u.prototype.isCompleteDestination=function(e){return e.screen||e.results||e.redirect||e.kickout},u.prototype.nextQuestion=function(e,r){var i,o=this;return i=function(r,a,s){for(var u=n.getDependentQuestions(r.transitions),l=0;u.length>l;l++){var c=u[l];if(c===a.id)a.show=!0,s.question.push(a);else{var f=o.getQuestionById(e.questions,c);if(f){if(f.show=!1,f.selected=null,t.has(f,"answers")&&t.isArray(f.answers))for(var p=0;f.answers.length>p;p++)f.answers[p].selected=null;i(f,a,s),s.question.push(f)}}}},this.getNextQuestion(e,r,r.selected).then(function(e){var t={question:[]};if(r){var n;n=e.goTo&&e.goTo.question?e.goTo.question:{},i(r,n,t)}else e.goTo&&e.goTo.question&&(e.goTo.question.show=!0,t={question:[e.goTo.question]});return t})},u.prototype.getScreenNode=function(e){return this.screensPromise.then(function(t){var n;return t.has(e)&&(n=t.getNode(e)),n
})},u.prototype.nextScreen=function(n,r){var i,o,a,s=e.defer(),u=this;if(!t.isObject(n))return s.reject("Missing required parameters (screen)"),s.promise;if(r?t.isArray(r)||(r=[r]):r=[],u.storeProfileForQuestions(r),i={question:null,screen:null,results:!1,redirect:null,kickout:null},o=[],a=t.after(r.length,function(){var e=function(){i.kickout||(u.storeFlags(o),u.storeHistory(n,r,o)),s.resolve(i)};u.isCompleteDestination(i)?e():u.getScreenNode(n.id).then(function(t){t&&t.next?u.getScreen(t.next).then(function(t){i.screen=t,e()}):(i.results=!0,e())})}),r.length>0)for(var l=0;r.length>l;l++){var c=r[l];c.show===!1?a():this.getNextScreen(n,c,c.selected).then(function(e){u.isCompleteDestination(i)||(i=e.goTo),e&&t.isArray(e.setFlag)&&(o=o.concat(e.setFlag)),a()},function(){a()})}else a();return s.promise},u.prototype.previousScreen=function(){var n=r.popFromHistory(),i=e.defer(),o=this;return n&&n.screen?this.getScreen(n.screen).then(function(e){e&&(t.isArray(n.questions)&&(e.questions=n.questions),t.isArray(n.flags)&&o.removeFlags(n.flags)),i.resolve(e)}):i.reject("No previous screen"),i.promise},u.prototype.hasPreviousScreen=function(){return r.hasHistory()},u.prototype.storeHistory=function(e,t,n){e&&r.pushToHistory({screen:e.id,questions:t,flags:n})},u.prototype.storeFlags=function(e){r.addFlag(e)},u.prototype.removeFlags=function(e){r.removeFlag(e)},u.prototype.storeProfileForQuestions=function(e){if(t.isArray(e))for(var n=0;e.length>n;n++){var r=e[n];this.storeProfile(r.setProfile,r.selected)}},u.prototype.storeProfile=function(e,i){if(t.isObject(e)&&t.has(e,"property")){if(t.has(e,"modifier")){var o=t.isArray(e.modifier)?e.modifier:[e.modifier];i=n.applyModifiers(o,i)}r.setProfileProperty(e.property,i),a.process()}},u.prototype.resetSession=function(){r.reset()},new u(i)}])}(),function(){angular.module("Question").service("GetErrorMessagesService",function(){var e={};this.getMessages=function(){return e}})}(),function(){angular.module("Question").controller("QuestionPageController",["$scope","$state","$uiViewScroll","$sce","$timeout","_","questionsService","resultsService","sessionsService","translationContentService","blastService",function(e,t,n,r,i,o,a,s,u,l,c){e.questions=[],e.data=null,e.firstScreen=!1,e.hideSkipQuestion=!1;var f=0;l.getContentForPage("questions").then(function(t){e.t=t}),u.hasProfileProperty("year")||t.go("questions.year");var p=this;e.$on("$stateChangeSuccess",function(){a.hasPreviousScreen()?p.goToPreviousScreen():(a.loadScreens(),p.goToFirstScreen())}),this.goToFirstScreen=function(){var e=a.getFirstScreen(),t=this;e.then(function(e){t.swapScreens(e)},function(){},function(){})},this.goToPreviousScreen=function(){var n=this;a.hasPreviousScreen()?a.previousScreen().then(function(t){e.questions=[],n.swapScreens(t)})["catch"](function(){t.go("questions.year")}):t.go("questions.year")},this.goToResults=function(){t.go("results.show")},this.setScope=function(t){var n=this;t&&t.questions.length&&(e.data=t,angular.forEach(t.questions,function(t){var r=n.updateAnswers(t);r.hasOwnProperty("text")&&(r.text=n.compiledQuestionText(r.text)),e.questions.push(r)}));var r=u.getFlags();s.getExemptions(r).then(function(t){e.hasExemptions=t.length>0?!0:!1}),e.firstScreen=!1,t&&(e.hideSkipQuestion=t.hideskip)},this.getNextAction=function(n,r){if(n.results&&n.results===!0)this.goToResults();else if(n.redirect){var i=u.getProfileProperty("year").value;t.go("stateExchange",{statename:n.redirect,Year:i})}else if("question"===r&&n.question);else if("screen"===r&&n.screen)e.questions=[],this.swapScreens(n.screen);else{if("screen"!==r||!n.kickout)return;l.get("questions.kickouts."+n.kickout).then(function(e){angular.element("#kickoutModal div.modal-body h1").html(e.header),angular.element("#kickoutModal div.modal-body p").html(e.description),angular.element("#kickoutModal div.modal-body button.button1").html(e.button1.text),angular.element("#kickoutModal div.modal-body button.button2").html(e.button2.text),angular.element("#kickoutModal div.modal-body button.button1").attr("aria-label",e.button1.text),angular.element("#kickoutModal div.modal-body button.button2").attr("aria-label",e.button2.text),angular.element("#kickoutModal div.modal-body button.button1").click(function(t){t.preventDefault(),window.location.href=e.button1.href}),angular.element("#kickoutModal").modal("show")})}},this.swapScreens=function(t){this.setScope(t),f=0,e.$emit("contentViewLoaded"),t&&c.pageView(t.id)},e.$on("questionLoaded",function(){f++,f>=e.questions.length&&e.$emit("contentViewLoaded")}),e.$on("contentViewLoaded",function(){document.activeElement&&document.activeElement.blur();var t=document.getElementById("exemptionMainView");t&&n(angular.element(t));var r=$(".question_view legend, .question_view label"),o=$(".hasExemptions > *"),a=e.hasExemptions?o:r;i(function(){a==o&&o.is(":hidden")&&(a=r),a&&a.length>0&&a.filter(":first").attr("tabindex",-1).focus()})}),this.updateAnswers=function(e){if(this.allowMultiples(e)&&e.selected){var t;if(t=o.isArray(e.selected)?e.selected:[e.selected],o.isArray(e.answers))for(var n=0;e.answers.length>n;n++){var r=e.answers[n],i=o.indexOf(t,r.id);r.selected=i>=0?t[i]:null}e.selected=null}return e},this.setAnswers=function(e){var t=this;return angular.forEach(e,function(e){if(t.allowMultiples(e)){var n=[];if(o.isArray(e.answers))for(var r=0;e.answers.length>r;r++){var i=e.answers[r];o.has(i,"selected")&&i.selected&&(e.show!==!1?n.push(i.selected):i.selected=null)}e.selected=n}}),e},this.clearAnswers=function(e){return angular.forEach(e,function(e){e.selected=null,o.isArray(e.answers)&&angular.forEach(e.answers,function(e){e.selected=null})}),e},this.allowMultiples=function(e){return e&&("checkbox"===e.type||"month-picker"===e.type)},this.compiledQuestionText=function(e){if("object"==typeof e){var t={};return angular.forEach(e,function(e,n){var r=o.template(e);t[n]=r(u.data)}),t}return e},e.$on("requestNewScreen",angular.bind(this,function(t,n){if(!e.questions.length)return!1;var r=e.data,i=n?this.clearAnswers(e.questions):this.setAnswers(e.questions);try{n?c.trackEvent(r.id,"skip-screen",r.id):"location"==r.id&&c.trackEvent(r.id,"zip-county",e.questions[0].selected.name);var o=a.nextScreen(r,i),s=this;o.then(function(e){s.getNextAction(e,"screen")},function(e){console.log(e)})}catch(u){console.log(u)}})),e.$on("requestLastScreen",angular.bind(this,function(){this.goToPreviousScreen()})),e.$on("questionAnswered",angular.bind(this,function(t,n,r){var i=e.data,o=a.getQuestionById(i.questions,r);if(o){o.selected="string"==typeof n||null===n?n:n.$modelValue;var s=a.nextQuestion(i,o),u=this;s.then(function(e){u.getNextAction(e,"question")},function(){},function(){})}})),e.$on("showResultPage",angular.bind(this,function(){c.trackEvent(e.data.id,"see-results-now",e.data.id),a.storeHistory(e.data,e.questions,[]),this.goToResults()})),e.$on("resetForm",angular.bind(this,function(){var t=this;a.getScreen(e.data.id).then(function(n){e.questions=[],t.swapScreens(n)})}))}])}(),function(){angular.module("Question").controller("QuestionFormController",["$scope",function(e){e.disableButton=!0}])}(),function(){angular.module("Question").controller("IntroPageController",["$scope","translationContentService",function(e,t){t.getContentForPage("views.intro").then(function(t){e.t=t}),angular.element("#introModal").on("hidden.bs.modal",function(){angular.element(".introView").attr("aria-hidden",!1)}),angular.element("#introModal").on("shown.bs.modal",function(){angular.element(".introView").attr("aria-hidden",!0)})}])}(),function(){angular.module("Question").directive("errors",["GetErrorMessagesService",function(e){return{controller:["$scope",function(t){t.errorMessages="",this.handleErrors=function(n){var r=!1,i=e.getMessages();return angular.forEach(n.$error,function(e,n){e?(t.errorMessages=i[n],r=!0):t.errorMessages=""}),r}}],restrict:"EA",scope:{field:"@"},transclude:!0,templateUrl:"modules/module_question/directives/templates/errors.html"}}])}(),function(){angular.module("Question").directive("questionForm",["$timeout",function(){return{restrict:"EA",transclude:!0,scope:{data:"="},controller:"QuestionFormController",templateUrl:"modules/module_question/directives/templates/form.html",replace:!0,link:function(e,t){e.$watch(function(){return t.hasClass("ng-valid")},function(e){e?$("#questionNext").prop("disabled",!1):$("#questionNext").prop("disabled",!0)})}}}])}(),function(){angular.module("Question").directive("questionFields",[function(){return{restrict:"EA",transclude:!0,replace:!0,templateUrl:"modules/module_question/directives/templates/fields.html"}}])}(),function(){angular.module("Question").directive("questionField",[function(){return{restrict:"EA",transclude:!0,replace:!0,scope:"&",templateUrl:"modules/module_question/directives/templates/field.html",link:function(e,t){e.$watch("field.show",function(e){t.attr("aria-hidden",e===!1)})}}}])}(),function(){angular.module("Question").directive("questionContent",function(){return{restrict:"AE",link:function(e){e.$emit("questionLoaded")}}})}(),function(){var e=angular.injector(["ng","Question"]).invoke(["questionsService",function(e){return e.getQuestionTypes()}]);angular.forEach(e,function(e){var t={restrict:"EA",link:function(){},controller:function(){},scope:{id:"=",required:"=",label:"=",ngClick:"&",ngBlur:"&"}};angular.module("Question").directive(e,["$rootScope","$compile",function(e){var n=angular.extend({},t,{require:["^errors","ngModel"],replace:!0,scope:!0,transclude:!0,link:function(t,n,r,i){var o=i[1],a=i[0];t.blurred=t.changed=function(){var t=a.handleErrors(o),n=r.questionId;t||e.$broadcast("questionAnswered",o,n)},t.id=t[r.id],t.label=t[r.label],t.ngModel=t[r.ngModel],t.ngBlur=t[r.blurred]}});return n}])})}(),function(){angular.module("Question").directive("buttonNext",["$rootScope",function(e){return{scope:{label:"@label",t:"@"},replace:!0,restrict:"A",controller:"QuestionFormController",link:function(t){var n=function(){e.$broadcast("requestNewScreen")};t.moveForward=function(){n()}},templateUrl:"modules/module_question/directives/templates/button_next.html"}}])}(),function(){angular.module("Question").directive("buttonBack",["$rootScope",function(e){return{scope:{label:"@label",t:"@"},replace:!0,restrict:"A",controller:"QuestionFormController",link:function(t){var n=function(){e.$broadcast("requestLastScreen")};t.moveBackward=function(){n()}},templateUrl:"modules/module_question/directives/templates/button_back.html"}}])}(),function(){angular.module("Question").directive("buttonSkip",["$rootScope",function(e){return{scope:{label:"@label",t:"@"},replace:!0,restrict:"A",controller:"QuestionFormController",link:function(t){var n=function(){e.$broadcast("requestNewScreen",!0)};t.moveForward=function(){n()}},templateUrl:"modules/module_question/directives/templates/button_skip.html"}}])}(),function(){angular.module("Question").directive("introContent",[function(){return{restrict:"A",templateUrl:"modules/module_question/directives/templates/intro_content.html",link:function(e,t){t.ready(function(){$("h1").attr("tabindex",-1).focus()})}}}])}(),function(){angular.module("Question").directive("resultsButton",["$rootScope",function(){return{scope:{label:"@label"},replace:!0,restrict:"A",controller:"QuestionFormController",link:function(){},templateUrl:"modules/module_question/directives/templates/results_button.html"}}])}(),function(){angular.module("Question").directive("modal",["$rootScope",function(e){return{template:'<div class="modal fade introModal" role="dialog" aria-hidden="true" tabindex="-1" aria-describedby="info"><div class="modal-dialog"><div class="modal-content"><div class="modal-body" ng-transclude></div></div></div></div>',restrict:"EA",transclude:!0,replace:!0,scope:!0,link:function(t,n,r){t.title=r.title,t.$watch(r.visible,function(e){e===!0?n.modal("show"):n.modal("hide")}),n.on("shown.bs.modal",function(){angular.element(".modal-backdrop").removeClass("fade"),n.attr("aria-hidden",!1),n.removeClass("fade")}),angular.element("button[data-action]").on("click",function(){e.$broadcast(angular.element(this).attr("data-action"))})}}}])}(),function(){angular.module("Question").config(["$stateProvider",function(e){e.state("questions",{url:"/",templateUrl:"modules/module_question/views/question_page.html","abstract":!0,controller:["$scope","$rootScope","translationContentService",function(e,t,n){n.getContentForPage("questions").then(function(t){e.t=t}),e.showResults=function(){t.$broadcast("showResultPage")}}]}).state("questions.intro",{url:"",templateUrl:"modules/module_question/views/intro.html",controller:"IntroPageController as introCntrl"}).state("questions.screens",{url:"questions",templateUrl:"modules/module_question/views/form.html",controller:"QuestionPageController as pageCtrl"})}])}(),function(){angular.module("Results",["ui.router","Util","Config","Session","Content","ExemptionsYear"])}(),function(){var e=angular.module("Results");e.filter("groupExemptions",["_",function(e){return function(t){var n,r=e.toArray(arguments).slice(1);return n=r.length>0?e.filter(t,function(t){return e.contains(r,t.type)}):t}}])}(),function(){var e=angular.module("Results");e.filter("minLength",["_",function(e){return function(t,n){return e.isArray(t)||(t=[t]),t.length>=n}}])}(),function(){var e=angular.module("Results");e.factory("emailService",["_","$q","$state","$location","objectUtil","translationContentService","translationsService","stringsUtil","sessionsService",function(e,t,n,r,i,o,a,s,u){var l,c,f,p=function(){};return l=function(e){return o.getTranslatedProperty("results.share.email",e)},c=function(e){return r.absUrl().replace("#"+r.url(),e)},f=function(t,r,o){var a=[];if(e.isArray(t)&&t.length>0){var l=[],f=[];a.push(i.getPropertyFromPath("introText",r));for(var p=0;t.length>p;p++){var d,h=t[p],m=h.details||h.id,g=n.href("details",{ExemptionId:m,Year:u.getProfileProperty("year").value});d=s.formatString(i.getPropertyFromPath("exemptionItem",r),h.name[o],c(g)),"irs"===h.type||"both"===h.type?f.push(d):"ffm"===h.type&&l.push(d)}f.length>0&&(a.push(""),a.push(i.getPropertyFromPath("labels.irs",r)),a=a.concat(f)),l.length>0&&(a.push(""),a.push(i.getPropertyFromPath("labels.ffm",r)),a=a.concat(l)),a.push(i.getPropertyFromPath("closeText",r))}else a.push(i.getPropertyFromPath("noExemptions",r));return escape(a.join("\n"))},p.prototype.getEmailSubject=function(){return l().then(function(e){return i.getPropertyFromPath("subject",e)})},p.prototype.getEmailBody=function(e){var t=a.getLanguage();return l(t).then(function(n){return f(e,n,t)})},p.prototype.getEmail=function(e){var n=this,r={};return t.all([n.getEmailSubject(),n.getEmailBody(e)]).then(function(e){return r.subject=e[0],r.body=e[1],r},function(){return r})},new p}])}();var results=angular.module("Results");results.factory("exemptionsDataService",["$http","$q","_","configurationService","exemptionsYearService",function(e,t,n,r,i){var o=function(e){this.pathToData=e,this.data=void 0};return o.prototype.loadData=function(){this.pathToData=i.getExemptionsPath(),this.data=void 0},o.prototype.getData=function(){var r=this,i=t.defer();return n.isUndefined(this.data)?e.get(this.pathToData).success(function(e){r.data=e}).error(function(){r.data={}})["finally"](function(){i.resolve(r.data)}):i.resolve(r.data),i.promise},o.prototype.getExemptions=function(){var e=this,r=t.defer();return e.getData().then(function(e){var t;t=n.has(e,"exemptions")?e.exemptions:[],r.resolve(t)}),r.promise},new o(i.getExemptionsPath())}]),function(){var e=angular.module("Results");e.factory("exemptionsContentService",["_","translationsService",function(e,t){var n,r,i=function(){};return n=function(t,n){return e.has(t,n)&&(e.isObject(t[n])||e.isString(t[n]))},r=function(n){var r;if(e.isObject(n)){var i=t.getLanguage();e.has(n,i)&&(r=n[i])}else e.isString(n)&&(r=n);return r},i.prototype.processExemption=function(t){return e.isObject(t)?(n(t,"name")&&(t.name.content=r(t.name)),t):t},new i}])}(),function(){var e=angular.module("Results");e.factory("resultsService",["_","exemptionsDataService","exemptionsContentService",function(e,t,n){var r=function(e){this.dataService=e};return r.prototype.loadExemptions=function(){return this.exemptionsPromise=this.dataService.getExemptions().then(function(e){return e})},r.prototype.getExemptionGroupings=function(t){var r=this.isQualified;return this.loadExemptions().then(function(i){for(var o={},a=0;i.length>a;a++){var s=i[a];if(r(s,t)){var u=s.type;u&&(e.has(o,u)||(o[u]=[]),o[u].push(n.processExemption(s)))}}return o})},r.prototype.getExemptions=function(t){return this.getExemptionGroupings(t).then(function(t){return e.flatten(e.values(t))})},r.prototype.isQualified=function(t,n){var r=!1;if(e.has(t,"flags")){if(e.isArray(t.flags))if(1>t.flags.length)r=!0;else if(e.isArray(n))var r=e.every(t.flags,function(t){return e.indexOf(n,t)>=0})}else r=!0;return r},r.prototype.getExemptionByID=function(t){return this.loadExemptions().then(function(n){var r;if(e.isArray(n))for(var i=0;!r&&n.length>i;){var o=n[i++];o.id===t&&(r=o)}return r})},new r(t)}])}(),function(){angular.module("Results").controller("ResultsController",["_","$scope","$state","$uiViewScroll","resultsService","sessionsService","emailService","translationContentService","blastService",function(e,t,n,r,i,o,a,s,u){var l=o.getFlags();if(t.showBack=o.hasHistory(),t.year,!o.hasProfileProperty("year"))return n.go("questions.intro"),void 0;t.year=o.getProfileProperty("year").value,s.getContentForPage("results").then(function(e){t.t=e,c()}),i.getExemptions(l).then(function(e){e.length>0?(angular.forEach(e,function(t,n){e[n].details=t.details||t.id}),t.resultsData=e,a.getEmail(e).then(function(e){t.email=e}),u.pageView("results")):(n.go("results.none"),u.pageView("no-results"))});var c=function(){document.activeElement&&document.activeElement.blur();var e=document.getElementById("exemptionMainView"),t=document.getElementById("exemptionResultView");if(e&&t){var n=document.getElementById("result-description-title");n.focus(),r(angular.element(n))}};t.nextStepEvent=function(e,t,n){u.trackEvent("results","next-steps-"+t+"-"+n,"results")},t.$on("backToScreener",angular.bind(this,function(){n.go("questions.screens")})),t.$on("restartScreener",angular.bind(this,function(){o.reset(),n.go("questions.screens")}))}])}(),function(){var e=angular.module("Results");e.controller("StateExchangeController",["_","$scope","$stateParams","$uiViewScroll","translationContentService","blastService",function(e,t,n,r,i,o){var a=e.isString(n.statename)?n.statename.toLowerCase():null,s=n.Year;i.getContentForPage("views.state-exchange","",s).then(function(n){if(t.t=n,e.has(n,"state-info")){var r=n["state-info"];a&&e.has(r,a)||(a="none"),t.info=r[a]}u(),o.pageView("state-exchange-"+a)});var u=function(){document.activeElement&&document.activeElement.blur();var e=document.getElementById("exemptionMainView"),t=document.getElementById("exemptionResultView");e&&t&&(e.focus(),r(angular.element(t)))};t.nextStepEvent=function(){o.trackEvent("state-exchange-"+a,"state-exchange-access","state-exchange-"+a)}}])}(),function(){angular.module("Results").directive("backToScreener",["$rootScope",function(e){return{scope:{label:"@label",t:"@"},replace:!0,restrict:"A",link:function(t){var n=function(){e.$broadcast("backToScreener")};t.backToScreener=function(){n()}},templateUrl:"modules/module_results/directives/templates/button_back-to-screener.html"}}])}(),function(){angular.module("Results").directive("shareResults",["$rootScope","blastService",function(e,t){return{scope:{label:"@label",subjectText:"=",bodyText:"=",t:"@"},replace:!0,restrict:"A",link:function(e){e.shareScreener=function(){t.trackEvent("results","email-my-results","results")}},templateUrl:"modules/module_results/directives/templates/button_share-results.html"}}])}(),function(){angular.module("Results").directive("restartScreener",["$rootScope","blastService",function(e,t){return{scope:{label:"@label",t:"@"},replace:!0,restrict:"A",link:function(n){var r=function(){e.$broadcast("restartScreener")};n.restartScreener=function(){t.trackEvent("results","start-over","results"),r()}},templateUrl:"modules/module_results/directives/templates/button_restart-screener.html"}}])}(),function(){angular.module("Results").directive("bindHtmlCompileNoResult",["$compile","blastService",function(e,t){return{restrict:"A",controller:["$scope",function(e){e.noResultLink=function(e){t.trackEvent("no-results","click-results-link",e.target.innerHTML)}}],scope:{bindHtmlCompileNoResult:"="},link:function(t,n){n.html(t.bindHtmlCompileNoResult.replace(/href/g,'ng-click="noResultLink($event)" href')),e(n.contents())(t)}}}])}(),function(){angular.module("Results").config(["$stateProvider",function(e){e.state("results",{url:"/results",templateUrl:"modules/module_results/views/results.html","abstract":!0,controller:"ResultsController"}).state("results.show",{url:"",templateUrl:"modules/module_results/views/show_results.html"}).state("results.none",{url:"",templateUrl:"modules/module_results/views/no_results.html"}).state("stateExchange",{url:"/redirect/{Year}/:statename",templateUrl:"modules/module_results/views/state_exchange.html",controller:"StateExchangeController"})}])}(),function(){angular.module("Details",["ui.router","ngRoute","Util","Config","Content"])}(),function(){var e=angular.module("Details");e.factory("detailsContentService",["$q","_","objectUtil","htmlContentService","configurationService",function(e,t,n,r,i){var o=function(){};return o.prototype.getContentForExemption=function(n,o){var a=e.defer();if(t.isString(n)&&t.isString(o)){var s=i.get("exemptions.pathToDetails");e.all([r.get(s+o+"/"+n)]).then(function(e){for(var t,n=$(e[0]).children(),r="",i="",o=0;n.length>o;o++){var s=$(n[o]).prop("tagName").toLowerCase(),u="<"+s+">"+$(n[o]).html()+"</"+s+">";t||"hr"!==s?t?i+=u:r+=u:t=!0}r="<div class='col-sm-offset-2 col-sm-8 col-sm-offset-2'>"+r+"</div>",i="<div class='col-sm-offset-2 col-sm-8 col-sm-offset-2'>"+i+"</div>",n.length>0?a.resolve({hero:r,content:i}):a.reject("Content not found")})}else a.reject("Unknown exemption");return a.promise},new o}])}(),function(){angular.module("Details").controller("DetailsController",["$scope","$state","$stateParams","detailsContentService","blastService",function(e,t,n,r,i){var o=n.ExemptionId,a=n.Year,s=function(){t.go("questions.intro")};o?r.getContentForExemption(o,a).then(function(t){e.details=t,gov.hc.survey.init(),i.pageView("details-"+o)},function(){s()}):s()}])}(),function(){angular.module("Details").config(["$stateProvider",function(e){e.state("details-old",{url:"/results/details/{ExemptionId:[^/]+}",controller:["$stateParams","$state",function(e,t){var n=e.ExemptionId;t.go("details",{Year:"2014",ExemptionId:n})}]}).state("details",{url:"/results/{Year}/details/{ExemptionId:[^/]+}",templateUrl:"modules/module_details/views/details_page.html",controller:"DetailsController"})}])}(),function(){angular.module("Details").directive("bindHtmlCompileDetailsContent",["$compile",function(e){return{restrict:"A",scope:{bindHtmlCompileDetailsContent:"="},link:function(t,n){t.$watch("bindHtmlCompileDetailsContent",function(){t.bindHtmlCompileDetailsContent&&(n.html(t.bindHtmlCompileDetailsContent),e(n.contents())(t),gov&&gov.hc&&gov.hc.glossary&&"function"==typeof gov.hc.glossary.tooltip&&gov.hc.glossary.tooltip('a[title="glossary"]'))})}}}])}(),function(){angular.module("Tracking",["Util"])}(),function(){var e=angular.module("Tracking");e.factory("blastService",[function(){var e=function(){};return e.prototype.check=function(){return!("undefined"==typeof utag)},e.prototype.pageView=function(e){this.check()&&utag.view({screen_id:e,page_type:"tool",page_topic:"exemptions",page_audience:"individuals"})},e.prototype.trackEvent=function(e,t,n){this.check()&&utag.link({event_name:"exemptions-tool",screen_id:e,ga_eventCategory:"exemptions-tool",ga_eventAction:t,ga_eventLabel:n})},new e}])}();